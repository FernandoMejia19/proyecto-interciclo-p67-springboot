<div class="container_perfil-usuario" *ngIf="perfil; else cargando">
    <div class="portada-usuario">
        <img class="imagen-usuario" 
            [src]="perfil.photoURL ? perfil.photoURL : 'https://lienzocreativo.com/blog/wp-content/uploads/2020/03/primer-plano.jpg'" 
            alt="Foto de perfil">
        
        <div class="encabezado-usuario">
            <span>{{ perfil.nombre || perfil.email }}</span>
            
            <div class="tecnologias-usuario">
                <p>Tecnolog√≠as:</p>
                <div class="tec" *ngFor="let tech of perfil.tecnologias">
                    {{ tech }}
                </div>
                <span *ngIf="!perfil.tecnologias || perfil.tecnologias.length === 0" style="font-size: 1rem; margin-left: 10px;">
                    (Sin tecnolog√≠as)
                </span>
            </div>
        </div>
    </div>

    <div class="container-contenido">
        <div class="informacion-usuario">
            <p><strong>Nombre:</strong> {{ perfil.nombre }}</p>
            <p><strong>Ciudad:</strong> {{ perfil.ciudad || 'No especificada' }}</p>
            <p><strong>Pa√≠s:</strong> {{ perfil.pais || 'No especificado' }}</p>
            <p><strong>Descripci√≥n:</strong></p>
            <p>{{ perfil.descripcion || 'Sin descripci√≥n disponible.' }}</p>
        </div>
        <div class="contenido-dinamico">
            
            <div class="menu-tabs">
                <button [class.activo]="seccionActiva === 'proyectos'" 
                        (click)="cambiarSeccion('proyectos')">
                    Mis Proyectos
                </button>
                <button [class.activo]="seccionActiva === 'citas'" 
                        (click)="cambiarSeccion('citas')">
                    Mis Asesor√≠as
                </button>
                <button *ngIf="isAdmin" 
                        [class.activo]="seccionActiva === 'usuarios'" 
                        (click)="cambiarSeccion('usuarios')"
                        style="color: #dc3545; font-weight: bold;">
                    üõ°Ô∏è Gestionar Usuarios
                </button>
            </div>
            <div class="proyectos-container" *ngIf="seccionActiva === 'proyectos'">
                <div class="barra-acciones">
                    <button class="btn-crear-full" (click)="crearNuevoProyecto()">
                        üöÄ Crear Nuevo Proyecto
                    </button>
                </div>
                <div *ngIf="proyectos.length === 0" class="no-proyectos">
                    <p>A√∫n no has subido ning√∫n proyecto.</p>
                </div>

                <div class="grid-proyectos">
                    <div class="card-proyecto" *ngFor="let pro of proyectos">
                        <img [src]="pro.imagen || 'assets/default-project.png'" class="img-proyecto">
                        
                        <div class="info-proyecto">
                            <h4>{{ pro.titulo }}</h4>
                            <p>{{ pro.descripcion }}</p>
                        </div>

                        <div class="acciones-proyecto">
                            <button class="btn-editar" (click)="editarProyecto(pro.id)">
                                Editar
                            </button>
                            <button class="btn-eliminar" (click)="eliminarProyecto(pro.id)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="citas-container" *ngIf="seccionActiva === 'citas'">
                <app-mis-citas></app-mis-citas>
            </div>
            <div class="admin-container" *ngIf="seccionActiva === 'usuarios' && isAdmin">
                <app-admin-usuarios></app-admin-usuarios>
            </div>
        </div>
    </div>
</div>

<ng-template #cargando>
    <div style="padding: 50px; text-align: center; color: white;">
        Cargando perfil...
    </div>
</ng-template>